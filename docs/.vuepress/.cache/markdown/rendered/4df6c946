{"content":"<h2 id=\"proxy-能够监听对象中的对象的引用吗\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#proxy-能够监听对象中的对象的引用吗\"><span>Proxy 能够监听对象中的对象的引用吗？</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>Proxy 能够监听对象中的对象的引用吗？</p>\n</div>\n<hr>\n<p><strong>不能直接监听。</strong></p>\n<p><code v-pre>Proxy</code> 默认只代理对象的一层属性。如果对象的某个属性值本身是另一个对象（嵌套对象），那么对该嵌套对象 <strong>内部属性的读写操作</strong>，<strong>不会触发外层 Proxy 的拦截器（handler）</strong>，\n因为嵌套对象本身 <strong>不是 Proxy</strong>，而是原始引用。</p>\n<h3 id=\"示例\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#示例\"><span>示例：</span></a></h3>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">  a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">];</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 不会触发任何日志！</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>原因：<code v-pre>proxy.a</code> 返回的是原始对象 <code v-pre>{ b: 1 }</code>，对它的 <code v-pre>.b = 2</code> 操作完全绕过了外层 Proxy。</p>\n<hr>\n<h3 id=\"如何监听嵌套对象\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#如何监听嵌套对象\"><span>如何监听嵌套对象？</span></a></h3>\n<p>必须对<strong>每个嵌套对象也创建 Proxy</strong>，即实现 <strong>深度代理</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">function</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ===</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ||</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> typeof</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> !==</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">  Object</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">forEach</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">((</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 递归代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  return</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 返回也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 新值也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Vue 3 的 <VPLink href=\"/web/vue/vue3/#reactive\">reactive()</VPLink> 就是基于这种深度 Proxy 实现的。Vue3 中的响应系统可<VPLink href=\"/web/vue/principle/#%E5%93%8D%E5%BA%94%E7%B3%BB%E7%BB%9F\">阅读这里</VPLink>。</p>\n<h2 id=\"apply、call、bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply、call、bind\"><span>apply、call、bind</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>apply、call、bind 的区别？</p>\n</div>\n<hr>\n<p><code v-pre>apply</code>、<code v-pre>call</code>、<code v-pre>、bind</code> 都是用来改变函数执行上下文的，也就是函数运行时 this 的指向。</p>\n<h3 id=\"apply\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply\"><span>apply</span></a></h3>\n<p><code v-pre>apply</code> 接收两个参数：<code v-pre>function.apply(thisArg, [argsArray])</code>。第一个参数是 this 的指向，第二个参数是函数接收的参数且以数组的形式传入。且第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。\n<code v-pre>apply</code> 调用函数后会立即执行，且 this 指向只临时改变一次。</p>\n<ClientOnly>\n  <JSRunner :code=\"code1\" />\n</ClientOnly>\n<h3 id=\"call\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#call\"><span>call</span></a></h3>\n<p><code v-pre>call</code> 与 <code v-pre>bind</code> 很多相似之处：接收两个参数、调用函数后也会立即执行，且 this 指向只临时改变一次、当第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。它们的区别在于 <code v-pre>call</code> 传入的第二个参数是一个参数列表。</p>\n<ClientOnly>\n  <JSRunner :code=\"code2\" />\n</ClientOnly>\n<h3 id=\"bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#bind\"><span>bind</span></a></h3>\n<p><code v-pre>bind</code> 传入的参数与 <code v-pre>call</code> 一样，第一个为指定的 <code v-pre>this</code> ，第二个为 <strong>参数列表</strong>。区别在于它不是立即执行，而是返回一个永久改变\n<code v-pre>this</code> 指向的函数，且第二个参数可以分多次传入（因为已经如同另一个函数）。</p>\n<ClientOnly>\n  <JSRunner :code=\"code3\" />\n</ClientOnly>\n<h3 id=\"对比表\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#对比表\"><span>对比表</span></a></h3>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>apply</th>\n<th>call</th>\n<th>bind</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>参数</td>\n<td>thisArg, [argsArray]</td>\n<td>thisArg, arg1, arg2, ...</td>\n<td>thisArg, arg1, arg2, ...</td>\n</tr>\n<tr>\n<td>执行</td>\n<td>立即执行</td>\n<td>立即执行</td>\n<td>返回一个改变 this 指向的函数</td>\n</tr>\n<tr>\n<td>this</td>\n<td>临时改变</td>\n<td>临时改变</td>\n<td>永久改变</td>\n</tr>\n<tr>\n<td>参数列表</td>\n<td>数组</td>\n<td>参数列表</td>\n<td>参数列表</td>\n</tr>\n</tbody>\n</table>\n","env":{"base":"/","filePath":"D:/002-zhy-git/front-end-interview-docs/docs/basic/JavaScript/4.JavaScript/5.高级特性与API.md","filePathRelative":"basic/JavaScript/4.JavaScript/5.高级特性与API.md","frontmatter":{"title":"高级特性与API","createTime":"2025/11/24 14:34:03","permalink":"/qa/javascript/f528v9fu/","outline":2},"sfcBlocks":{"template":{"type":"template","content":"<template><h2 id=\"proxy-能够监听对象中的对象的引用吗\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#proxy-能够监听对象中的对象的引用吗\"><span>Proxy 能够监听对象中的对象的引用吗？</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>Proxy 能够监听对象中的对象的引用吗？</p>\n</div>\n<hr>\n<p><strong>不能直接监听。</strong></p>\n<p><code v-pre>Proxy</code> 默认只代理对象的一层属性。如果对象的某个属性值本身是另一个对象（嵌套对象），那么对该嵌套对象 <strong>内部属性的读写操作</strong>，<strong>不会触发外层 Proxy 的拦截器（handler）</strong>，\n因为嵌套对象本身 <strong>不是 Proxy</strong>，而是原始引用。</p>\n<h3 id=\"示例\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#示例\"><span>示例：</span></a></h3>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">  a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">];</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 不会触发任何日志！</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>原因：<code v-pre>proxy.a</code> 返回的是原始对象 <code v-pre>{ b: 1 }</code>，对它的 <code v-pre>.b = 2</code> 操作完全绕过了外层 Proxy。</p>\n<hr>\n<h3 id=\"如何监听嵌套对象\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#如何监听嵌套对象\"><span>如何监听嵌套对象？</span></a></h3>\n<p>必须对<strong>每个嵌套对象也创建 Proxy</strong>，即实现 <strong>深度代理</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">function</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ===</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ||</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> typeof</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> !==</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">  Object</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">forEach</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">((</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 递归代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  return</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 返回也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 新值也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Vue 3 的 <VPLink href=\"/web/vue/vue3/#reactive\">reactive()</VPLink> 就是基于这种深度 Proxy 实现的。Vue3 中的响应系统可<VPLink href=\"/web/vue/principle/#%E5%93%8D%E5%BA%94%E7%B3%BB%E7%BB%9F\">阅读这里</VPLink>。</p>\n<h2 id=\"apply、call、bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply、call、bind\"><span>apply、call、bind</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>apply、call、bind 的区别？</p>\n</div>\n<hr>\n<p><code v-pre>apply</code>、<code v-pre>call</code>、<code v-pre>、bind</code> 都是用来改变函数执行上下文的，也就是函数运行时 this 的指向。</p>\n<h3 id=\"apply\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply\"><span>apply</span></a></h3>\n<p><code v-pre>apply</code> 接收两个参数：<code v-pre>function.apply(thisArg, [argsArray])</code>。第一个参数是 this 的指向，第二个参数是函数接收的参数且以数组的形式传入。且第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。\n<code v-pre>apply</code> 调用函数后会立即执行，且 this 指向只临时改变一次。</p>\n<ClientOnly>\n  <JSRunner :code=\"code1\" />\n</ClientOnly>\n<h3 id=\"call\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#call\"><span>call</span></a></h3>\n<p><code v-pre>call</code> 与 <code v-pre>bind</code> 很多相似之处：接收两个参数、调用函数后也会立即执行，且 this 指向只临时改变一次、当第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。它们的区别在于 <code v-pre>call</code> 传入的第二个参数是一个参数列表。</p>\n<ClientOnly>\n  <JSRunner :code=\"code2\" />\n</ClientOnly>\n<h3 id=\"bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#bind\"><span>bind</span></a></h3>\n<p><code v-pre>bind</code> 传入的参数与 <code v-pre>call</code> 一样，第一个为指定的 <code v-pre>this</code> ，第二个为 <strong>参数列表</strong>。区别在于它不是立即执行，而是返回一个永久改变\n<code v-pre>this</code> 指向的函数，且第二个参数可以分多次传入（因为已经如同另一个函数）。</p>\n<ClientOnly>\n  <JSRunner :code=\"code3\" />\n</ClientOnly>\n<h3 id=\"对比表\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#对比表\"><span>对比表</span></a></h3>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>apply</th>\n<th>call</th>\n<th>bind</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>参数</td>\n<td>thisArg, [argsArray]</td>\n<td>thisArg, arg1, arg2, ...</td>\n<td>thisArg, arg1, arg2, ...</td>\n</tr>\n<tr>\n<td>执行</td>\n<td>立即执行</td>\n<td>立即执行</td>\n<td>返回一个改变 this 指向的函数</td>\n</tr>\n<tr>\n<td>this</td>\n<td>临时改变</td>\n<td>临时改变</td>\n<td>永久改变</td>\n</tr>\n<tr>\n<td>参数列表</td>\n<td>数组</td>\n<td>参数列表</td>\n<td>参数列表</td>\n</tr>\n</tbody>\n</table>\n</template>","contentStripped":"<h2 id=\"proxy-能够监听对象中的对象的引用吗\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#proxy-能够监听对象中的对象的引用吗\"><span>Proxy 能够监听对象中的对象的引用吗？</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>Proxy 能够监听对象中的对象的引用吗？</p>\n</div>\n<hr>\n<p><strong>不能直接监听。</strong></p>\n<p><code v-pre>Proxy</code> 默认只代理对象的一层属性。如果对象的某个属性值本身是另一个对象（嵌套对象），那么对该嵌套对象 <strong>内部属性的读写操作</strong>，<strong>不会触发外层 Proxy 的拦截器（handler）</strong>，\n因为嵌套对象本身 <strong>不是 Proxy</strong>，而是原始引用。</p>\n<h3 id=\"示例\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#示例\"><span>示例：</span></a></h3>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">  a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">];</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">  set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">a</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">b</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 不会触发任何日志！</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>原因：<code v-pre>proxy.a</code> 返回的是原始对象 <code v-pre>{ b: 1 }</code>，对它的 <code v-pre>.b = 2</code> 操作完全绕过了外层 Proxy。</p>\n<hr>\n<h3 id=\"如何监听嵌套对象\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#如何监听嵌套对象\"><span>如何监听嵌套对象？</span></a></h3>\n<p>必须对<strong>每个嵌套对象也创建 Proxy</strong>，即实现 <strong>深度代理</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"js\" style=\"--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212\"><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code class=\"language-js\"><span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">function</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  if</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ===</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> null</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> ||</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> typeof</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> !==</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">object</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> return</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">  Object</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">keys</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">).</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">forEach</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">((</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 递归代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  return</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> new</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> Proxy</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">obj</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">get</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 返回也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">set</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">      target</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">key</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">);</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> // 新值也需代理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    },</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  });</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>Vue 3 的 <VPLink href=\"/web/vue/vue3/#reactive\">reactive()</VPLink> 就是基于这种深度 Proxy 实现的。Vue3 中的响应系统可<VPLink href=\"/web/vue/principle/#%E5%93%8D%E5%BA%94%E7%B3%BB%E7%BB%9F\">阅读这里</VPLink>。</p>\n<h2 id=\"apply、call、bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply、call、bind\"><span>apply、call、bind</span></a></h2>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">问题</p>\n<p>apply、call、bind 的区别？</p>\n</div>\n<hr>\n<p><code v-pre>apply</code>、<code v-pre>call</code>、<code v-pre>、bind</code> 都是用来改变函数执行上下文的，也就是函数运行时 this 的指向。</p>\n<h3 id=\"apply\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#apply\"><span>apply</span></a></h3>\n<p><code v-pre>apply</code> 接收两个参数：<code v-pre>function.apply(thisArg, [argsArray])</code>。第一个参数是 this 的指向，第二个参数是函数接收的参数且以数组的形式传入。且第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。\n<code v-pre>apply</code> 调用函数后会立即执行，且 this 指向只临时改变一次。</p>\n<ClientOnly>\n  <JSRunner :code=\"code1\" />\n</ClientOnly>\n<h3 id=\"call\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#call\"><span>call</span></a></h3>\n<p><code v-pre>call</code> 与 <code v-pre>bind</code> 很多相似之处：接收两个参数、调用函数后也会立即执行，且 this 指向只临时改变一次、当第一个参数为 <code v-pre>null</code> 或 <code v-pre>undefined</code> 时 <code v-pre>this</code> 指向 window 。它们的区别在于 <code v-pre>call</code> 传入的第二个参数是一个参数列表。</p>\n<ClientOnly>\n  <JSRunner :code=\"code2\" />\n</ClientOnly>\n<h3 id=\"bind\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#bind\"><span>bind</span></a></h3>\n<p><code v-pre>bind</code> 传入的参数与 <code v-pre>call</code> 一样，第一个为指定的 <code v-pre>this</code> ，第二个为 <strong>参数列表</strong>。区别在于它不是立即执行，而是返回一个永久改变\n<code v-pre>this</code> 指向的函数，且第二个参数可以分多次传入（因为已经如同另一个函数）。</p>\n<ClientOnly>\n  <JSRunner :code=\"code3\" />\n</ClientOnly>\n<h3 id=\"对比表\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#对比表\"><span>对比表</span></a></h3>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>apply</th>\n<th>call</th>\n<th>bind</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>参数</td>\n<td>thisArg, [argsArray]</td>\n<td>thisArg, arg1, arg2, ...</td>\n<td>thisArg, arg1, arg2, ...</td>\n</tr>\n<tr>\n<td>执行</td>\n<td>立即执行</td>\n<td>立即执行</td>\n<td>返回一个改变 this 指向的函数</td>\n</tr>\n<tr>\n<td>this</td>\n<td>临时改变</td>\n<td>临时改变</td>\n<td>永久改变</td>\n</tr>\n<tr>\n<td>参数列表</td>\n<td>数组</td>\n<td>参数列表</td>\n<td>参数列表</td>\n</tr>\n</tbody>\n</table>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":{"content":"<script setup>\nlet code3 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nconst bindFn = fn.bind(obj, 1) // this 永久指向 obj , 参数为 [1]\nbindFn(2,3) // 返回的函数可以分为多次传入，此时参数为 [1,2,3]\nbindFn(4,5) // 返回的函数可以分为多次传入，此时参数为 [1,4,5]\nfn(1,2,3,4) // 原函数的 this 仍然指向 Window\n`\n\nlet code1 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nfn.apply(null, [1]) // this 指向 window , 参数为 [1]\nfn.apply(obj, [1, 2]) // 临时改变 this 为 obj，参数为 [1, 2]\nfn(1,2,3) // this 为 Window，参数为 [1, 2, 3]\n`\n\nlet code2 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: \"Hoey\" }\n\nfn.call(obj, 1, 2, 3) // 临时改变 this 为 obj，参数为 [1, 2, 3]\nfn(1,2) // this 为 Window，参数为 [1, 2]\n`\n</script>","tagOpen":"<script setup>","type":"script","contentStripped":"\nlet code3 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nconst bindFn = fn.bind(obj, 1) // this 永久指向 obj , 参数为 [1]\nbindFn(2,3) // 返回的函数可以分为多次传入，此时参数为 [1,2,3]\nbindFn(4,5) // 返回的函数可以分为多次传入，此时参数为 [1,4,5]\nfn(1,2,3,4) // 原函数的 this 仍然指向 Window\n`\n\nlet code1 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nfn.apply(null, [1]) // this 指向 window , 参数为 [1]\nfn.apply(obj, [1, 2]) // 临时改变 this 为 obj，参数为 [1, 2]\nfn(1,2,3) // this 为 Window，参数为 [1, 2, 3]\n`\n\nlet code2 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: \"Hoey\" }\n\nfn.call(obj, 1, 2, 3) // 临时改变 this 为 obj，参数为 [1, 2, 3]\nfn(1,2) // this 为 Window，参数为 [1, 2]\n`\n","tagClose":"</script>"},"scripts":[{"content":"<script setup>\nlet code3 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nconst bindFn = fn.bind(obj, 1) // this 永久指向 obj , 参数为 [1]\nbindFn(2,3) // 返回的函数可以分为多次传入，此时参数为 [1,2,3]\nbindFn(4,5) // 返回的函数可以分为多次传入，此时参数为 [1,4,5]\nfn(1,2,3,4) // 原函数的 this 仍然指向 Window\n`\n\nlet code1 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nfn.apply(null, [1]) // this 指向 window , 参数为 [1]\nfn.apply(obj, [1, 2]) // 临时改变 this 为 obj，参数为 [1, 2]\nfn(1,2,3) // this 为 Window，参数为 [1, 2, 3]\n`\n\nlet code2 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: \"Hoey\" }\n\nfn.call(obj, 1, 2, 3) // 临时改变 this 为 obj，参数为 [1, 2, 3]\nfn(1,2) // this 为 Window，参数为 [1, 2]\n`\n</script>","tagOpen":"<script setup>","type":"script","contentStripped":"\nlet code3 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nconst bindFn = fn.bind(obj, 1) // this 永久指向 obj , 参数为 [1]\nbindFn(2,3) // 返回的函数可以分为多次传入，此时参数为 [1,2,3]\nbindFn(4,5) // 返回的函数可以分为多次传入，此时参数为 [1,4,5]\nfn(1,2,3,4) // 原函数的 this 仍然指向 Window\n`\n\nlet code1 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nfn.apply(null, [1]) // this 指向 window , 参数为 [1]\nfn.apply(obj, [1, 2]) // 临时改变 this 为 obj，参数为 [1, 2]\nfn(1,2,3) // this 为 Window，参数为 [1, 2, 3]\n`\n\nlet code2 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: \"Hoey\" }\n\nfn.call(obj, 1, 2, 3) // 临时改变 this 为 obj，参数为 [1, 2, 3]\nfn(1,2) // this 为 Window，参数为 [1, 2]\n`\n","tagClose":"</script>"}],"styles":[],"customBlocks":[]},"content":"## Proxy 能够监听对象中的对象的引用吗？\n\n::: tip 问题\nProxy 能够监听对象中的对象的引用吗？\n:::\n\n---\n\n**不能直接监听。**\n\n`Proxy` 默认只代理对象的一层属性。如果对象的某个属性值本身是另一个对象（嵌套对象），那么对该嵌套对象 **内部属性的读写操作**，**不会触发外层 Proxy 的拦截器（handler）**，\n因为嵌套对象本身 **不是 Proxy**，而是原始引用。\n\n### 示例：\n\n```js\nconst obj = {\n  a: { b: 1 },\n};\n\nconst proxy = new Proxy(obj, {\n  get(target, key) {\n    console.log(\"get\", key);\n    return target[key];\n  },\n  set(target, key, value) {\n    console.log(\"set\", key, value);\n    target[key] = value;\n  },\n});\n\nproxy.a.b = 2; // 不会触发任何日志！\n```\n\n原因：`proxy.a` 返回的是原始对象 `{ b: 1 }`，对它的 `.b = 2` 操作完全绕过了外层 Proxy。\n\n---\n\n### 如何监听嵌套对象？\n\n必须对**每个嵌套对象也创建 Proxy**，即实现 **深度代理**：\n\n```js\nfunction reactive(obj) {\n  if (obj === null || typeof obj !== \"object\") return obj;\n  Object.keys(obj).forEach((key) => {\n    obj[key] = reactive(obj[key]); // 递归代理\n  });\n  return new Proxy(obj, {\n    get(target, key) {\n      console.log(\"get\", key);\n      return reactive(target[key]); // 返回也需代理\n    },\n    set(target, key, value) {\n      console.log(\"set\", key, value);\n      target[key] = reactive(value); // 新值也需代理\n      return true;\n    },\n  });\n}\n```\n\nVue 3 的 [reactive()](/web/vue/vue3/#reactive) 就是基于这种深度 Proxy 实现的。Vue3 中的响应系统可[阅读这里](/web/vue/principle/#响应系统)。\n\n## apply、call、bind\n\n::: tip 问题\napply、call、bind 的区别？\n:::\n\n---\n\n`apply`、`call`、`、bind` 都是用来改变函数执行上下文的，也就是函数运行时 this 的指向。\n\n### apply\n\n`apply` 接收两个参数：`function.apply(thisArg, [argsArray])`。第一个参数是 this 的指向，第二个参数是函数接收的参数且以数组的形式传入。且第一个参数为 `null` 或 `undefined` 时 `this` 指向 window 。\n`apply` 调用函数后会立即执行，且 this 指向只临时改变一次。\n\n<ClientOnly>\n  <JSRunner :code=\"code1\" />\n</ClientOnly>\n\n### call\n\n`call` 与 `bind` 很多相似之处：接收两个参数、调用函数后也会立即执行，且 this 指向只临时改变一次、当第一个参数为 `null` 或 `undefined` 时 `this` 指向 window 。它们的区别在于 `call` 传入的第二个参数是一个参数列表。\n\n<ClientOnly>\n  <JSRunner :code=\"code2\" />\n</ClientOnly>\n\n### bind\n\n`bind` 传入的参数与 `call` 一样，第一个为指定的 `this` ，第二个为 **参数列表**。区别在于它不是立即执行，而是返回一个永久改变\n`this` 指向的函数，且第二个参数可以分多次传入（因为已经如同另一个函数）。\n\n<ClientOnly>\n  <JSRunner :code=\"code3\" />\n</ClientOnly>\n\n### 对比表\n\n|   | apply | call | bind |\n| --- | --- | --- | --- |\n| 参数 | thisArg, [argsArray] | thisArg, arg1, arg2, ... | thisArg, arg1, arg2, ... |\n| 执行 | 立即执行 | 立即执行 | 返回一个改变 this 指向的函数 |\n| this | 临时改变 | 临时改变 | 永久改变 |\n| 参数列表 | 数组 | 参数列表 | 参数列表 |\n\n<script setup>\nlet code3 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nconst bindFn = fn.bind(obj, 1) // this 永久指向 obj , 参数为 [1]\nbindFn(2,3) // 返回的函数可以分为多次传入，此时参数为 [1,2,3]\nbindFn(4,5) // 返回的函数可以分为多次传入，此时参数为 [1,4,5]\nfn(1,2,3,4) // 原函数的 this 仍然指向 Window\n`\n\nlet code1 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: 'Hoey' }\n\nfn.apply(null, [1]) // this 指向 window , 参数为 [1]\nfn.apply(obj, [1, 2]) // 临时改变 this 为 obj，参数为 [1, 2]\nfn(1,2,3) // this 为 Window，参数为 [1, 2, 3]\n`\n\nlet code2 = `function fn(...args){\n  console.log(this)\n  console.log(args)\n}\nlet obj = { name: \"Hoey\" }\n\nfn.call(obj, 1, 2, 3) // 临时改变 this 为 obj，参数为 [1, 2, 3]\nfn(1,2) // this 为 Window，参数为 [1, 2]\n`\n</script>","excerpt":"","includedFiles":[],"tasklistId":0,"title":"","headers":[{"level":2,"title":"Proxy 能够监听对象中的对象的引用吗？","slug":"proxy-能够监听对象中的对象的引用吗","link":"#proxy-能够监听对象中的对象的引用吗","children":[{"level":3,"title":"示例：","slug":"示例","link":"#示例","children":[]},{"level":3,"title":"如何监听嵌套对象？","slug":"如何监听嵌套对象","link":"#如何监听嵌套对象","children":[]}]},{"level":2,"title":"apply、call、bind","slug":"apply、call、bind","link":"#apply、call、bind","children":[{"level":3,"title":"apply","slug":"apply","link":"#apply","children":[]},{"level":3,"title":"call","slug":"call","link":"#call","children":[]},{"level":3,"title":"bind","slug":"bind","link":"#bind","children":[]},{"level":3,"title":"对比表","slug":"对比表","link":"#对比表","children":[]}]}],"links":[{"raw":"/web/vue/vue3/","absolute":"/web/vue/vue3/","relative":"web/vue/vue3"},{"raw":"/web/vue/principle/","absolute":"/web/vue/principle/","relative":"web/vue/principle"}]}}
